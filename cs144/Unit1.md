
* 互联网的基本原理 
* 如今的设计 优势和劣势
* 普遍接受的互联网设计
* 什么是互联网
* 互联网四层模型

## 互联网应用 

联网应用可以在全世界交换数据

![](img/2af453ad.png)

### 通信方式 双向可靠字节流 

当今网络中最常用的通信模式

1. B在等待其他计算机的连接 A在连接到B
2. AB建立连接
3. A在向连接写入数据 而B从连接中读取
4. 反之B写入 A读取
5. 任意一方都可以关闭连接 *连接被服务器重置* *关闭页面*
    * 同样服务端也可以拒绝连接甚至不响应连接

![](img/bd4d1bd1.png)

### 应用 万维网

使用一种称为`HTTP`的协议 **超文本传输协议**

* `http://` 意味着使用这种协议进行通信

`http`中 客户端会打开一个到服务器的连接 并向其发送命令

* 命令常见有`GET` 用于请求一个页面
* `http`被设计为**面向文档**地在程序间通信

1. 建立连接
2. 客户端 发送`GET`请求
    * 此外还有`PUT` `DELETE` `INFO` 等请求
3. 服务端验证请求是否有效
    * 有效则返回一个响应 其中包括一个数字状态码 `200 OK`表示请求被接受 响应的其余部分 包含文档数据
    * 还有其他响应 `400` 请求错误

`http`的所有内容是ASCII码 是人类可读的

`GET`请求的开头是这样

```http
GET / HTTP/1.1
```

成功响应的开头是这样

```http
HTTP/1.1 200 OK
```

### 应用 bittorrent

一款允许人们共享和交换大型文件的程序

**客户端从其他客户端**中请求文档

将文件分解成称之为**片**的数据块

客户端从另一客户端下载完整的片后 会告诉其他客户端它拥有该片 以便他们下载 这些协同工作的客户端称为**群**

使用和万维网相同的机制 **可靠双向字节流** 但是使用方式复杂一些

1. 客户端想要下载文件 首先要找到**种子文件**
    * 通常使用万维网找到 并通过`http`下载
    * 种子文件 描述有关下载的数据文件的一些信息 以及告知客户端该种子的**跟踪器**是谁
    * 跟踪器 是一个节点 负责跟踪哪些客户端是群的成员 
2. 我的客户端通过跟踪器 获取 群的客户端列表
3. 我的客户端和其他一些客户端建立连接 并开始请求文件的部分内容
4. 与此同时 跟踪器记录我的客户端加入了群 其他新加入的客户端也可以和我建立连接 请求文件的部分

一张密集的客户端之间的连接图 动态交换数据

![](img/fd82b13c.png)

### 应用 skype

流行的语音聊天和视频服务

在简单模式下 类似于`http` 呼叫者和接受者建立联系 并交换数据

但是区别在于彼此都是客户端 两台计算机相互请求数据

![](img/51b5ce0b.png)

更复杂的是引入`NAT` **网络地址转换器**

* 通过引入NAT 可以连接到互联网 但是互联网外部却不能轻易连接到NAT背后的计算机

![](img/6a4def34.png)

通过引入一个`Rendezvous`的**控制服务器**解决 

1. 当B登录`Skype`时，B客户端会打开到控制服务器的连接
2. 当A呼叫B时，会向控制服务器发送消息 
3. 此时控制服务器通过和B的连接 通知B 有A的呼叫请求 
4. 如果B接受请求 那么会主动发起和A的连接（这样就由NAT后面的客户端主动连接）**反向连接**

![](img/a7a61c54.png)

出于安全考虑 个人电脑通常在NAT背后 而需要公共访问的服务器通常不会

那么如果两个客户端都在NAT背后呢

引入一个**中继服务器** 两个客户端都和中继服务器建立连接 中继服务器转发双方的数据

![](img/5996d275.png)
