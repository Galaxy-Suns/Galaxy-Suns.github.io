# 命令行

* `cmd`是`powershell`的子集
* 不区分大小写
* 上下键查看历史命令
* `Tab`自动补全
* `/?` `/help`查看用法 `[]`表示可选

## 壹 基本命令

### 1.1 echo pause cls exit 打印 暂停 清屏 退出

* `echo 消息` 打印消息
* `pause` 暂停, 提示*按任意键继续*
  * `pause > nul` 把提示消息输入到一个空文件
* `cls` 清屏
* `exit` 退出

### 1.2 type findstr fc 文件相关基础操作

* `type 文件名.后缀` 显示文件内容 **中文内容应编码为gbk**
* `findstr "字符串" 文件名.后缀` 查找字符串
* `fc 文件名.后缀 文件名.后缀` **powershell 无此命令** 打印出不同行, 以及其前后行

### 1.3 其它常用命令

* `date` 打印日期, 修改 `/T` 不修改, 只打印
* `time` 打印时间 和`date`同理
* `ping 域名` 网络连通测试
* `ipconfig` TCP/IP信息
* `set /a 表达式` 计算表达式 `+ - * / %`
* `shutdown /s` 关机 加 `/t 秒数` 定时 定时后输入`shutdown /a`取消定时

## 贰 常用命令

### 2.1 & && || 多命令 

* `&` 顺序执行多个命令, 不管命令是否实现成功
* `&&` 顺序执行多个命令, 如果执行到错误命令终止执行
* `||` 顺序执行多个命令, 如果执行到正确命令终止执行

### 2.2 > >> < 重定向

* 默认输出到端口/从端口输入的信息, 如果想要输出到某文件/从某文件输入, 可以采用这种方式
* `>`输出重定向 以**覆盖形式**输出到某文件
* `>>` 追加重定向 以**追加形式**输出到某文件
* `<` 输入重定向 将文件内容作为输入

### 2.3 | 管道命令

* 将一个命令的输出作为另一个命令的输入
* `命令a | 命令b` 把a命令的输出作为b命令的输入

## 叁 文件操作

* win下的路径用`\`分割, 而不是linux的除号`/`
* 当前目录`.` 上一级目录`..`

### dir 显示文件

* `dir` 展示当前的目录下的所有文件 `/a`可以展示其它属性如隐藏的文件

### tree 显示文件结构

* `tree` 将当前目录的文件结构以类似树的形式展示

### c: d: 盘符

* `c:` 进入c盘

### cd 切换目录

* `cd 目录`切换到某目录
* `cd ..` 切换上一级目录

### mkdir md 创建目录

* `mkdir(md) 目录名`

### rmdir rd 删除模块

* `rmdir 目录名`

### del 删除文件

* `del 文件.后缀`删除文件

### rename 重命名文件

* `rename 旧名字.后缀 新名字.后缀` 

### copy 复制文件

* `copy 文件.后缀 新路径\新文件名.后缀`

### move 移动文件

* `move 文件.后缀 新路径\新文件名.后缀`

## 肆 批处理

注释 rem ... 

* `@echo off`关闭回写
* 可以依次执行多行命令
* `pause > nul` 防止关闭

**可以在`cmd`中执行, 也可以双击运行, `cmd`运行可以传一些参**

### 4.1 变量

#### 4.1.1 变量的基本使用

* 定义变量 `set a=abc` *注意等号前后无空格*
* 输出变量 `echo %a%` 变量的引用使用`%`
* 取消变量 `set a=` 
* 列出所有变量 `set` *可以看到我们的一些系统变量和环境变量, 这些都可以使用*
* 用户输入`set /p a=提示文字`

```sh
@echo off

rem 注意 如果定义为一个表达式要加 /a

set /a a=5 + 6 * 5 
echo %a%

pause > nul
```

#### 4.1.2 预定义变量

* `%cd%` 当前目录
* `%date%` 当前日期
* `%time%` 当前时间
* `%random%`0-32767间的随机数
* `%path%` 环境变量
* `%errorlevel%` 上一个命令的返回值 `0`正常 `非0`异常
* `%数字` 参数 `bat`的名字会作为第0个参数


```sh
@echo off

rem 这样批处理文件中就获取到了输入的参数
echo %0 %1 %2


pause > nul
```

### 4.2 call 调用

* `call 可执行文件 [参数列表]`
* 这里的参数列表作为可执行文件的参数**传入**

### 4.3 if else 条件结构

```sh
#位置不能改
if [not] 条件 (
    语句块
) else (
    语句块
)
```

**条件**

* `errorlevel number` 表示上一个程序的返回值大于等于 number 则为`true`
* `[/i] string1==string2` 判断两个字符串是否匹配, 可以用`%`引用变量 `/i`忽略大小写
* `exist 文件.后缀` 判断某个文件是否存在
* `[/i] 字符串1/数值 操作符 字符串2/数值` 比较两个字符串/数值是否..
  * `equ` 相等
  * `neq` 不等于
  * `lss` 不等于
  * `leq` 小于等于
  * `gtr` 大于
  * `geq` 大于等于
* `define 变量`判断变量是否定义  *在关闭终端前, 多次执行的变量都被记录*

```sh
@echo off

set /p a=请输入a:
set /p b=请输入b:

IF %a% equ %b% (
    echo %a%等于%b%
) ELSE (
    IF %a% GTR %b% (
        echo %a%大于%b%
    ) ELSE (
        echo %a%小于%b%
    )
)

set a=
set b=

pause > nul
```

### 4.4 goto 跳转

* `goto 标签`跳转到某一标签
* `:标签`定义标签

### 4.5 for in do 循环

```sh
rem 循环变量由 %% 指定 只能是单字母
rem set表示文件集合, 可以为空文件/字符串, 元素之间以空格或逗号分隔 *.*表示该目录下所有文件 * 表示包含文件夹的所有文件
for %%i in (set) do (
    语句块
)
```

* 只遍历文件夹`for /d %%i in (set) do`
* 遍历文件夹下的所有文件 `for /r [文件夹] %%i in (set) do` 当前目录下所有文件, 包括更深的, 加上**文件夹参数**表示指定文件夹下的 `set`参数为`.`则为枚举所有目录, 除开文件
* 遍历数字序列 `for /l %%i in (start,step,end) do`包括首尾
* 遍历文件内容 `for /f %%i in (文件.后缀) do`


**在循环中变量如果自增不会立即执行, 需要`setlocal ENABLEDELAYEDEXPANSION`**

### 4.6 通配符

* `*`任意字符
* `?`单个字符