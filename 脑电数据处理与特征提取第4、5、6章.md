# 脑电数据处理与特征提取第4、5、6章



## 第四章 *降噪和预处理*

```
了脑电信号中常见的伪迹类型，然后介绍了预处理的多种方法及其实现
```

### 伪迹

*任何一个检测到的信号都不可避免地会受到干扰源的污染，可以说伪迹 是影响脑电信号的一些干扰信号*

* 生理伪迹  *一般来源于生物体本身，最常见的是因眨眼、眼动、舌动、心 跳、呼吸、肌肉运动和汗腺兴奋等产生的电生理信号*  眼电伪迹  肌电伪迹 心电伪迹 头皮出汗造成的伪迹

 ```
 目前，有几种常用的方法可以在有效去除眼电伪迹的同时保留脑电信号，如基于独立成分分析的方
 法（independent component analysis, ICA；Jung et al.，2000）和基于回归的
 方法（Gratton et al.，1983）
 ```

* 非生理伪迹 *来自外界环境的干扰，最常见的是市电干扰* 电极的不良放置会导致非生理伪迹的产生

```
为减少非生理伪迹，最简单的方法是从环境入手，如屏蔽房间，适当固定电极和使用活性电极（内含额外的低噪放大器）等
```

### 导联方法

* 国际10-20系统 *，“10”和“20”代表着相邻 电极之间的距离为总距离（头骨前后连线或左右连线）的10%或20%*
* 电极之间的电势差构成了通道，不同通道的组合即称为导联

```
在双极导联中，通道按横向或纵向呈链状排列，即第一个通道中的第二根导线是第二个通道的第一根导线，以此类推。在此种导联方式下，外部的噪声很容易被消除

在参考导联中，通道则代表有效电极与参考电极的电位差，这种方式既可以检测到参考电极与较近的电极点之间的电位差，也可以检测到其与较远的电极点之间的电势差

与双极导联相比，参考导联记录到的电势差更接近绝对电势差
```

### 滤波

*根据保留和去除的频率的不同，有四种滤波器类型：低通滤波器、高通 滤波器、带通滤波器和凹陷滤波器*

推荐将滤波作为预处理的第一步

### 重参考

* 对于参考电极，应该准确地放置

* 选择参考电极时，要尽可能地选择远离感兴趣区域的电极

### 脑电分段和基线校正

* 对刺激事件开始前后的 脑电数据进行分段

* 关于基线：自发脑电波导致的脑电噪声， 因此为“0时刻点”（受刺激或做出反应）前的数据的均值
* 静息态数据（我们的项目）：不需要矫正，按时分段

### 剔除或插值坏导 

*某些电极没有正确地被放置在头皮上，所以不能够准确地收集大脑神经生理信息，这些导联被称为坏导*

* 直接剔除坏导会减少数据中的通道数量，脑电数据矩阵会发生变 化

* 一种解决策略是根据正常导联的数据，通过插值来修复坏导的数据

```
最常用的插值方法是球面曲线法：①将所有导联一起投射到一个单
位球上；②计算将N个正常导联映射到M个坏导的映射矩阵；③利用该矩
阵来计算插值。所用的导联数越多，估计的插值越准确。
```

### 剔除坏段

* 某些分段试次存在明显的伪迹，例如眨眼和眼动伪迹

```
肌电伪迹主要集中在 15～40Hz，振幅相对较大，该伪迹常见于靠近脸部、脖子和耳朵附近的电极。当我们感兴趣的数据为15Hz以上的高频数据时，需要注意剔除被肌电伪迹污染的坏段。即使感兴趣的频率没有超过 15Hz，也建议剔除肌电伪迹明显的坏段，因为肌电伪迹太多说明被试在动，如打喷嚏、咳嗽或是笑，并没有专注于当前的实验任务。
```

```
有一种自动剔除坏段的方法，即通过比较脑电的峰间差值（Delorme & Makeig，2004；Oostenveld et al.，2011；Gramfort et al.，2014），若峰间差值超过预设值，该时段可被视为坏段，并被剔除。 阈值
```

### 基于ICA的伪迹去除 

*ICA 是由鸡尾酒会（cocktail party problem）问题引申出来的，用一种解 线性方程组的估计方式求解信号源，是一种解决盲源分离问题的有效方法*

```
从头皮上收集到的脑电原始数据可以被看作信号和伪迹（包括心电、眼电、肌电以及其他干扰源所产生的伪迹）的总和 分离信号和伪迹

ICA 分解原始脑电数据后，将分离的独立成分划分为伪迹相关成分和神经活动相关成分（Zou et al.，2016），剔除那些被标记为伪迹相关成分，并对其他数据进行重新组合。

在预处理中，ICA主要被用来去除眼动和心跳带来的伪迹，因为这些伪迹相关的独立成分有较为典型的特征
（地形、潜伏期、频谱），通常可以被自动识别出来。

与伪迹相关的成分集中在较高频段（大于30Hz），而神经信号一般集中在较低频段（如低于20Hz）。
```

## 第五章 *频谱分析和时频分析* 

```
对于脑电信号，尤其是自发脑电信号，通常是在频域中进行分析。频谱分析(快速傅里叶变换)可以将脑电信号从时域转换到频域
```

### 简介

* 对于脑电信号，尤其是自发脑电信号，一般在频域进行分析，以刻画信号的周期性特征

<span style="background-color: red;">或许有用</span>

```
特别是在 ERP实验中，感觉刺激或认知任务可以增强或减弱脑电在特定频段的节律幅度。这些事件相关的频谱变化被称为事件相关同步化（event-related synchronization，ERS）或事件相关去（event-related desynchronization，ERD）（Pfurtscheller & Da Silva，1999）。

ERS 或 ERD 通常表示为在时间-频率域中随时间变化的频谱功率，并可以通过时频分析（time-frequency analysis，TFA）方法进行估计（Roach & Mathalon，2008）。 
```



### 频谱估计

频率 **单位时间内完成周期性变化的次数**

*频谱估计可以将时域信号变换到频，并可提供信号的功率、幅度或相 位等沿频率的分布曲线（即频谱）（Kay，1988；Stoica & Moses，2005）*

```
一个时间序列信号（例如，在某通道连续记录的脑电活动）可以在时域中表征为信号幅度（或其他量值）相对于时间的变化，也可以在频域中表征为信号功率（或其他量值）沿频率变化的分布。
```

![image-20240521133810945](C:\code\md\img\image-20240521133810945.png)

```
通常计算一段时间内记录的脑电信号在以下几
个特定频段或节律内的功率：O（1～4Hz）、6（4～8Hz）、a（8～12Hz）、
B（12～20Hz）、y（>20Hz）"四种自发性EEG活动"
```

连续时间傅里叶变换：

![image-20240521134223075](C:\code\md\img\image-20240521134223075.png)

其中，f是频率，单位为Hz。频谱的频率范围是从0到信号采样率的一半[称 为奈奎斯特频率（Nyquist frequency）]。例如，图 5.2 中的脑电信号具有160Hz 的采样率，那么可以从该信号中检测到的最高频率是80Hz。 

我们的数据基础：实际采集分析的脑电信号都是在一系列离散时间点上的采样

![image-20240521134629836](C:\code\md\img\image-20240521134629836.png)



* 基于傅里叶变换，我们可以计算出信号的功率谱密度（power spectral  density，PSD），以描述随机信号的功率沿频率的分布。

* 功率谱密度可简称为 谱密度或功率谱，其单位是V^2/Hz或dB，即10log10（V2/Hz）

### 周期图

* 在实际应用中脑电功率谱一般是在一个很宽的频率范围内（例如，从6到 y波段）进行多频段分析，所以用对数尺度显示脑电的功率谱估计更为常见。
* 脑电频谱具有一个所谓的“1/f”特性（即功率随 着频率的增加而迅速减小），所以脑电的超低频成分（<1Hz）经常主导整个 频谱。因此，在脑电频谱估计之前必须执行一个“去趋势”（detrending）操 作，以消除超低频的影响。去趋势意味着移除信号的总体趋势（通常是一个 线性趋势）。

...

### 频谱特征提取

* 最常见的脑电频谱特征是**特定频段内的频谱功率** *在频域图中横坐标为某值时纵坐标的高度*

* 某一感兴趣的频段内 的**带限功率**可以计算为**该频段内所有频率点上功率的平均值或总和**

* 也常使用**相对功率（即某频段功率与整个频率范围内 总功率之间的比率）**作为特征
* 另外一类重要的脑电频谱特征是**频谱峰值的频率、幅度和带宽**

* 此外， 还可以将脑电信号频谱看作一个随机过程，从中计算其统计值，如平均值、 方差和熵等，作为脑电频谱特征。 

...

## 第六章 盲源分离

```
盲源分离（blind source separation，BSS），是在不需要源信号先验信息（或很少信息）与混合过程的条件下，对混合信号（观测信号）进行源信号估计的一种方法（Cardoso，1998）
```

...

